            - navn: Designite inkrementell kodekvalitetsanalyse
  # Du kan feste til den nøyaktige commiten eller versjonen.
  # bruksområder: DesigniteTools/designite-incremental-analysis@c9ec3cf4d058aa09194f2285f3e8f299cfdfd66f
  bruker: DesigniteTools/designite-incremental-analysis@v2.1.0
  med:
    # GitHub-token opprettet under utførelse av arbeidsflyt (satt til lesing og skriving)
    github-token:
    # Navn på utdatamappe for kodekvalitetsanalyse fra forrige commit
    designite-output-old:
    # Navn på mappe for utdata av kodekvalitetsanalyse fra gjeldende commit
    designite-utgang-ny:
    # Navn på arkiv
    repo-navn:
    # Verktøy brukt til kodeanalyse (dj eller dpy)
    verktøynavn:
                      - navn: Last opp en byggeartefakt
  bruker: actions/upload-artefakt@v5.0.0
  med:
    # Artefaktnavn
    navn: # valgfritt, standard er artefakt
    # En fil, katalog eller jokertegnmønster som beskriver hva som skal lastes opp
    sti:
    # Ønsket oppførsel hvis ingen filer blir funnet ved hjelp av den oppgitte banen.
Tilgjengelige alternativer:
  warn: Send ut en advarsel, men ikke mislykkes med handlingen
  feil: Handlingen mislykkes med en feilmelding
  ignorer: Ikke skriv ut noen advarsler eller feil, handlingen mislykkes ikke

    hvis-ingen-filer-funnet: # valgfritt, standard er warn
    # Varigheten som artefakten utløper etter i dager. 0 betyr at standard oppbevaring brukes.
Minimum 1 dag. Maksimum 90 dager med mindre det endres fra innstillingssiden for depotet.

    oppbevaringsdager: # valgfritt
    # Komprimeringsnivået Zlib skal bruke på artefaktarkivet. Verdien kan variere fra 0 til 9: - 0: Ingen komprimering - 1: Beste hastighet - 6: Standardkomprimering (samme som GNU Gzip) - 9: Beste komprimering Høyere nivåer vil gi bedre komprimering, men vil ta lengre tid å fullføre. For store filer som ikke lett kan komprimeres, anbefales en verdi på 0 for betydelig raskere opplastinger.

    komprimeringsnivå: # valgfritt, standard er 6
    # Hvis sann, vil en artefakt med et samsvarende navn bli slettet før en ny lastes opp. Hvis usann, vil handlingen mislykkes hvis en artefakt for det gitte navnet allerede finnes. Mislykkes ikke hvis artefakten ikke finnes.

    overskriv: # valgfritt, standard er usann
    # Hvis sann, vil skjulte filer bli inkludert i artefakten. Hvis usann, vil skjulte filer bli ekskludert fra artefakten.

    include-hidden-files: # valgfritt, standard er false
          
name: Android APK Builder (PROOF)

on:
  push:
    branches:
      - main
  workflow_dispatch:

env:
  JAVA_VERSION: '17'

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up JDK
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: ${{ env.JAVA_VERSION }}

      - name: Grant execute permission for gradlew
        run: chmod +x ./gradlew

      - name: Install Android command-line tools and SDK components
        run: |
          sudo apt-get update
          sudo apt-get install -y wget unzip lib32stdc++6 lib32z1
          wget https://dl.google.com/android/repository/commandlinetools-linux-10406996_latest.zip -O cmdline-tools.zip
          mkdir -p $HOME/Android/cmdline-tools
          unzip -q cmdline-tools.zip -d $HOME/Android/cmdline-tools
          export ANDROID_SDK_ROOT=$HOME/Android
          yes | $HOME/Android/cmdline-tools/cmdline-tools/bin/sdkmanager --sdk_root=$HOME/Android "platform-tools" "platforms;android-33" "build-tools;33.0.2"
        shell: bash

      - name: Set ANDROID_SDK_ROOT
        run: echo "ANDROID_SDK_ROOT=$HOME/Android" > $GITHUB_ENV

      - name: Build debug APK
        run: ./gradlew assembleDebug --no-daemon
        env:
          JAVA_TOOL_OPTIONS: "-Xmx2g"

      - name: Upload APK artifact
        uses: actions/upload-artifact@v4
        with:
          name: GeoSnapIndustridykk-debug-apk
          path: app/build/outputs/apk/debug/*.apk
